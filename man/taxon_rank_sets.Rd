% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/taxon_rank_sets.R
\name{taxon_rank_sets}
\alias{taxon_rank_sets}
\title{Taxon Rank Set Enrichment Analysis}
\usage{
taxon_rank_sets(taxon_ranks, lineage_df, min_set_size = 5, max_set_size = 100)
}
\arguments{
\item{taxon_ranks}{A named numeric vector of log2 fold changes.
Names should be feature identifiers matching the
\code{species} column in \code{lineage_df}, or matching
\code{rownames()} of a SummarizedExperiment/TreeSummarizedExperiment.}

\item{lineage_df}{Either a data frame or a
  \code{SummarizedExperiment}/\code{TreeSummarizedExperiment} object.

  \strong{Data frame input:} Must include a \code{species} column
  and one or more taxonomic rank columns (e.g., kingdom, phylum,
  class, order, family, genus). The \code{species} column is used
  for matching and is excluded from the enrichment analysis.

  \strong{SummarizedExperiment input:} Taxonomy is extracted from
  \code{rowData()} and feature identifiers from \code{rownames()}.
  If the \code{mia} package is installed, \code{taxonomyRanks()} is
  used to identify taxonomic rank columns; otherwise all
  \code{rowData()} columns are used. The Species rank column is
  automatically excluded from the analysis. Requires the
  \code{SummarizedExperiment} package.}

\item{min_set_size}{Minimum number of species in a set to include
in the analysis. Default is 5.}

\item{max_set_size}{Maximum number of species in a set to include
in the analysis. Default is 100.}
}
\value{
A named list of data frames, one per taxonomic rank. Each
  data frame contains columns: taxonSetName,
  median_rank_of_set_members, PValue, Test_statistic, and FDR.
  Ranks that produce no valid sets (e.g., due to size filtering)
  are included as empty data frames with a message.
}
\description{
Groups species by taxonomic ranks and performs TaxSEA enrichment
analysis at each rank level. Returns a named list of data frames,
one per taxonomic rank (excluding species).
}
\examples{
# --- Example 1: Data frame input ---
# Create a lineage data frame (e.g., parsed from curatedMetagenomicData)
# The 'species' column must match the names in taxon_ranks.

lineage_df <- data.frame(
  species = c("Cutibacterium_acnes", "Klebsiella_pneumoniae",
              "Propionibacterium_humerusii", "Moraxella_osloensis",
              "Enhydrobacter_aerosaccus", "Staphylococcus_capitis",
              "Staphylococcus_epidermidis", "Staphylococcus_aureus",
              "Escherichia_coli", "Enterobacter_cloacae",
              "Pseudomonas_aeruginosa", "Acinetobacter_baumannii",
              "Lactobacillus_rhamnosus", "Lactobacillus_acidophilus",
              "Bifidobacterium_longum", "Bifidobacterium_breve"),
  kingdom = rep("Bacteria", 16),
  phylum = c("Actinobacteria", "Proteobacteria",
             "Actinobacteria", "Proteobacteria",
             "Proteobacteria", "Firmicutes",
             "Firmicutes", "Firmicutes",
             "Proteobacteria", "Proteobacteria",
             "Proteobacteria", "Proteobacteria",
             "Firmicutes", "Firmicutes",
             "Actinobacteria", "Actinobacteria"),
  class = c("Actinobacteria", "Gammaproteobacteria",
            "Actinobacteria", "Gammaproteobacteria",
            "Alphaproteobacteria", "Bacilli",
            "Bacilli", "Bacilli",
            "Gammaproteobacteria", "Gammaproteobacteria",
            "Gammaproteobacteria", "Gammaproteobacteria",
            "Bacilli", "Bacilli",
            "Actinobacteria", "Actinobacteria"),
  order = c("Propionibacteriales", "Enterobacterales",
            "Propionibacteriales", "Pseudomonadales",
            "Rhodospirillales", "Bacillales",
            "Bacillales", "Bacillales",
            "Enterobacterales", "Enterobacterales",
            "Pseudomonadales", "Pseudomonadales",
            "Lactobacillales", "Lactobacillales",
            "Bifidobacteriales", "Bifidobacteriales"),
  family = c("Propionibacteriaceae", "Enterobacteriaceae",
             "Propionibacteriaceae", "Moraxellaceae",
             "Rhodospirillaceae", "Staphylococcaceae",
             "Staphylococcaceae", "Staphylococcaceae",
             "Enterobacteriaceae", "Enterobacteriaceae",
             "Pseudomonadaceae", "Moraxellaceae",
             "Lactobacillaceae", "Lactobacillaceae",
             "Bifidobacteriaceae", "Bifidobacteriaceae"),
  genus = c("Cutibacterium", "Klebsiella",
            "Cutibacterium", "Moraxella",
            "Enhydrobacter", "Staphylococcus",
            "Staphylococcus", "Staphylococcus",
            "Escherichia", "Enterobacter",
            "Pseudomonas", "Acinetobacter",
            "Lactobacillus", "Lactobacillus",
            "Bifidobacterium", "Bifidobacterium"),
  stringsAsFactors = FALSE
)

set.seed(42)
fc <- setNames(rnorm(16), lineage_df$species)
results <- taxon_rank_sets(fc, lineage_df, min_set_size = 2)
names(results)
results$family

# --- Example 2: SummarizedExperiment / TreeSummarizedExperiment input ---
\dontrun{
library(mia)
data(GlobalPatterns, package = "mia")
tse <- GlobalPatterns

# Run differential abundance (e.g., ALDEx2) to get fold changes
# aldex_out <- ... (your DA analysis)
# fc <- aldex_out$effect
# names(fc) <- rownames(aldex_out)

# Run taxon rank set enrichment directly from the TSE
results <- taxon_rank_sets(fc, tse, min_set_size = 5)
names(results)  # Kingdom, Phylum, Class, Order, Family, Genus
results$Family
}

}
